import"./wordCloud.1709626208081.js";import{_ as s,g as l}from"./index.1709626208081.js";import{d as e,a1 as a,aa as t,a as d,Y as n,S as c,b as r,ah as o,o as i,X as u,V as y,R as f,W as m,F as _,a7 as p,aA as v,aB as h}from"./vue.1709626208081.js";import"./echarts.1709626208081.js";const b=e({name:"monitor",components:{},setup(){const s=a({myCharts:[],sysInfo:{}});function e(l){const e=JSON.parse(l.data);s.sysInfo.keyspaceList=Object.keys(e),s.sysInfo.keyspace=e}function d(l){const e=JSON.parse(l.data);s.sysInfo.memory=e}function n(l){const e=JSON.parse(l.data);s.sysInfo.server=e}function c(l){const e=JSON.parse(l.data);s.sysInfo.cpu=e}function r(l){const e=JSON.parse(l.data);s.sysInfo.stats=e}function o(l){const e=JSON.parse(l.data);s.sysInfo.clients=e}return function(){const s=new EventSource(l("/base-api/subscribe/redisinfo"));s.addEventListener("stats",r),s.addEventListener("clients",o),s.addEventListener("cpu",c),s.addEventListener("server",n),s.addEventListener("memory",d),s.addEventListener("keyspace",e)}(),{...t(s)}},unmounted(){},data:()=>({}),methods:{memorySizeFormat(s){s=parseFloat(s);let l=0,e="Bytes";for(;s>1024&&"TB"!=e;)s/=1024,l++,1==l?e="KB":2==l?e="MB":3==l?e="GB":4==l&&(e="TB");return s.toFixed(2)+" "+e},lengthToFixed2:s=>(s=parseFloat(s)).toFixed(2),timeFormat(s){if(!s)return"-";s=parseFloat(s);let l=0,e="秒";for(;s>60&&"小时"!=e&&"天"!=e||s>24&&"小时"==e;)s/="小时"==e?24:60,l++,1==l?e="分":2==l?e="小时":3==l&&(e="天");return s.toFixed(2)+" "+e}}}),I=s=>(v("data-v-196f3044"),s=s(),h(),s),x={"class":"page"},g=I((()=>r("div",{"class":"card-header"},[
r("span",null,"客户端信息")],-1))),k={cellspacing:"0",style:{width:"100%"}},w={key:0},F=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"当前客户端连接数: ")],-1))),S={"class":"cell-card"},R=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"输出缓冲区中队列对象个数的最大值: ")],-1))),C={"class":"cell-card"},z=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"输入缓冲区中占用的最大容量:")],-1))),L={"class":"cell-card"},P=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"等待阻塞命令的客户端数量:")],-1))),U={"class":"cell-card"},T=I((()=>r("div",{"class":"card-header"},[
r("span",null,"CPU 信息")],-1))),B={cellspacing:"0",style:{width:"100%"}},E={key:0},O=I((()=>r("td",null,[
r("div",{"class":"cell-card",title:"Redis主进程在内核态所占用的CPU时钟总和"},"主进程内核态占用CPU时钟: ")],-1))),j={"class":"cell-card"},J=I((()=>r("td",null,[
r("div",{"class":"cell-card",title:"Redis主进程在用户态所占用的CPU时钟总和"},"主进程用户态占用CPU时钟: ")],-1))),N={"class":"cell-card"},K=I((()=>r("td",null,[
r("div",{"class":"cell-card",title:"Redis子进程在内核态所占用的CPU时钟总和"},"子进程内核态占用CPU时钟:")],-1))),A={"class":"cell-card"},G=I((()=>r("td",null,[
r("div",{"class":"cell-card",title:"Redis子进程在用户态所占用的CPU时钟总和"},"子进程用户态占用CPU时钟:")],-1))),M={"class":"cell-card"},V=I((()=>r("div",{"class":"card-header"},[
r("span",null,"服务信息")],-1))),W={cellspacing:"0",style:{width:"100%"}},X={key:0},Y=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Redis服务版本: ")],-1))),q={"class":"cell-card"},D=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"运行模式: ")],-1))),H={"class":"cell-card"},Q=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Redis所在机器的操作系统:")],-1))),Z={"class":"cell-card"},$=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"架构:")],-1))),ss={"class":"cell-card"},ls=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Redis所使用的事件处理机制:")],-1))),es={"class":"cell-card"},as=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"自Redis服务启动以来，运行的秒数:")],-1))),ts={"class":"cell-card"},ds=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"自Redis服务启动以来，运行的天数:")],-1))),ns={"class":"cell-card"},cs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"serverCron每秒运行次数:")],-1))),rs={"class":"cell-card"},os=I((()=>r("div",{"class":"card-header"},[
r("span",null,"内存信息")],-1))),is={key:0,cellspacing:"0",style:{width:"100%"}},us=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Redis分配器分配的内存总量: ")],-1))),ys={"class":"cell-card"},fs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"以可读的格式返回used_memory: ")],-1))),ms={"class":"cell-card"},_s=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"从操作系统的角度，Redis进程占用的物理内存总量:")],-1))),ps={"class":"cell-card"},vs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"内存使用的最大值:")],-1))),hs={"class":"cell-card"},bs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"以可读的格式返回used_memory_peak:")],-1))),Is={"class":"cell-card"},xs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Lua引擎所消耗的内存大小:")],-1))),gs={"class":"cell-card"},ks=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"内存碎片率:")],-1))),ws={"class":"cell-card"},Fs=I((()=>r("td",null,[
r("div",{"class":"cell-card"},"Redis所使用的内存分配器:")],-1))),Ss={"class":"cell-card"},Rs={"class":"flex-row gap-3"},Cs=I((()=>r("div",{"class":"card-header"},[
r("span",null,"基础统计信息")],-1))),zs={"class":"flex-row"},Ls={"class":"flex-row gap-3"},Ps=I((()=>r("div",{"class":"card-header"},[
r("span",null,"info Keyspace统计信息")],-1))),Us={key:0,style:{},"class":"flex-column"};var Ts=s(b,[["render",function(s,l,e,a,t,v){const h=o("el-card"),b=o("el-col"),I=o("el-row"),Ts=o("el-form-item"),Bs=o("el-form");return i(),d("div",x,[n(I,{gutter:15},{"default":c((()=>[n(b,{span:12,"class":"marg-b-15"},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[g])),"default":c((()=>[r("table",k,[s.sysInfo.clients?(i(),d("tbody",w,[r("tr",null,[F,r("td",null,[r("div",S,u(s.sysInfo.clients.connected_clients),1)])]),r("tr",null,[R,r("td",null,[r("div",C,u(s.sysInfo.clients.client_recent_max_output_buffer),1)])]),r("tr",null,[z,r("td",null,[r("div",L,u(s.memorySizeFormat(s.sysInfo.clients.client_recent_max_input_buffer)),1)])]),r("tr",null,[P,r("td",null,[r("div",U,u(s.sysInfo.clients.blocked_clients),1)])])])):y("",!0)])])),_:1})])),_:1}),n(b,{span:12,"class":"marg-b-15"},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[T])),"default":c((()=>[r("table",B,[s.sysInfo.cpu?(i(),d("tbody",E,[r("tr",null,[O,r("td",null,[r("div",j,u(s.lengthToFixed2(s.sysInfo.cpu.used_cpu_sys)),1)])]),r("tr",null,[J,r("td",null,[r("div",N,u(s.lengthToFixed2(s.sysInfo.cpu.used_cpu_user)),1)])]),r("tr",null,[K,r("td",null,[r("div",A,u(s.lengthToFixed2(s.sysInfo.cpu.used_cpu_sys_children)),1)])]),r("tr",null,[G,r("td",null,[r("div",M,u(s.lengthToFixed2(s.sysInfo.cpu.used_cpu_user_children)),1)])])])):y("",!0)])])),_:1})])),_:1})])),_:1}),n(I,{gutter:15},{"default":c((()=>[n(b,{span:12,"class":"marg-b-15"},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[V])),"default":c((()=>[r("table",W,[s.sysInfo.clients?(i(),d("tbody",X,[r("tr",null,[Y,r("td",null,[r("div",q,u(s.sysInfo.server.redis_version),1)])]),r("tr",null,[D,r("td",null,[r("div",H,u(s.sysInfo.server.redis_mode),1)])]),r("tr",null,[Q,r("td",null,[r("div",Z,u(s.sysInfo.server.os),1)])]),r("tr",null,[$,r("td",null,[r("div",ss,u(s.sysInfo.server.arch_bits),1)])]),r("tr",null,[ls,r("td",null,[r("div",es,u(s.sysInfo.server.multiplexing_api),1)])]),r("tr",null,[as,r("td",null,[r("div",ts,u(s.sysInfo.server.uptime_in_seconds),1)])]),r("tr",null,[ds,r("td",null,[r("div",ns,u(s.sysInfo.server.uptime_in_days),1)])]),r("tr",null,[cs,r("td",null,[r("div",rs,u(s.sysInfo.server.hz),1)])])])):y("",!0)])])),_:1})])),_:1}),n(b,{span:12,"class":"marg-b-15"},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[os])),"default":c((()=>[s.sysInfo.memory?(i(),d("table",is,[r("tbody",null,[r("tr",null,[us,r("td",null,[r("div",ys,u(s.memorySizeFormat(s.sysInfo.memory.used_memory))+" - "+u(s.lengthToFixed2(s.sysInfo.memory.used_memory/s.sysInfo.memory.maxmemory))+"% ",1)])]),r("tr",null,[fs,r("td",null,[r("div",ms,u(s.memorySizeFormat(s.sysInfo.memory.used_memory_human)),1)])]),r("tr",null,[_s,r("td",null,[r("div",ps,u(s.memorySizeFormat(s.sysInfo.memory.used_memory_rss)),1)])]),r("tr",null,[vs,r("td",null,[r("div",hs,u(s.memorySizeFormat(s.sysInfo.memory.used_memory_peak)),1)])]),r("tr",null,[bs,r("td",null,[r("div",Is,u(s.memorySizeFormat(s.sysInfo.memory.used_memory_peak_human)),1)])]),r("tr",null,[xs,r("td",null,[r("div",gs,u(s.memorySizeFormat(s.sysInfo.memory.used_memory_lua)),1)])]),r("tr",null,[ks,r("td",null,[r("div",ws,u(s.sysInfo.memory.mem_fragmentation_ratio),1)])]),r("tr",null,[Fs,r("td",null,[r("div",Ss,u(s.sysInfo.memory.mem_allocator),1)])])])])):y("",!0)])),_:1})])),_:1})])),_:1}),r("div",Rs,[n(b,{xs:24,sm:24,md:24,"class":"marg-b-15"},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[Cs])),"default":c((()=>[r("div",zs,[s.sysInfo.stats?(i(),f(Bs,{key:0,"label-position":"right","label-width":"160px","class":"flex1",style:{"max-width":"460px"}},{"default":c((()=>[n(Ts,{label:"连接过的客户端总数"},{"default":c((()=>[m(u(s.sysInfo.stats.total_connections_received),1)])),_:1}),n(Ts,{label:"执行过的命令总数"},{"default":c((()=>[m(u(s.sysInfo.stats.total_commands_processed),1)])),_:1}),n(Ts,{label:"每秒处理命令条数"},{"default":c((()=>[m(u(s.sysInfo.stats.instantaneous_ops_per_sec),1)])),_:1}),n(Ts,{label:"拒绝的连接个数"},{"default":c((()=>[m(u(s.sysInfo.stats.rejected_connections),1)])),_:1}),n(Ts,{label:"key数量"},{"default":c((()=>[m(u(s.sysInfo.stats.evicted_keys),1)])),_:1})])),_:1})):y("",!0),s.sysInfo.stats?(i(),f(Bs,{key:1,"label-position":"right","label-width":"160px","class":"flex1",style:{"max-width":"460px"}},{"default":c((()=>[n(Ts,{label:"网络总入流量"},{"default":c((()=>[m(u(s.memorySizeFormat(s.sysInfo.stats.total_net_input_bytes)),1)])),_:1}),n(Ts,{label:"网络总出流量"},{"default":c((()=>[m(u(s.memorySizeFormat(s.sysInfo.stats.total_net_output_bytes)),1)])),_:1}),n(Ts,{label:"每秒输入量"},{"default":c((()=>[m(u(s.sysInfo.stats.instantaneous_input_kbps)+" kb/s",1)])),_:1}),n(Ts,{label:"每秒输出量"},{"default":c((()=>[m(u(s.sysInfo.stats.instantaneous_output_kbps)+" kb/s",1)])),_:1}),n(Ts,{label:"最近fork消耗时间"},{"default":c((()=>[m(u(s.sysInfo.stats.evicted_keys)+" μs",1)])),_:1})])),_:1})):y("",!0),s.sysInfo.stats?(i(),f(Bs,{key:2,"label-position":"right","label-width":"160px","class":"flex1",style:{"max-width":"460px"}},{"default":c((()=>[n(Ts,{label:"主从完全同步成功次数"},{"default":c((()=>[m(u(s.sysInfo.stats.sync_full),1)])),_:1}),n(Ts,{label:"主从部分同步成功次数"},{"default":c((()=>[m(u(s.sysInfo.stats.sync_partial_ok),1)])),_:1}),n(Ts,{label:"主从部分同步失败次数"},{"default":c((()=>[m(u(s.sysInfo.stats.sync_partial_err),1)])),_:1}),n(Ts,{label:"正migrate的Redis个数"},{"default":c((()=>[m(u(s.sysInfo.stats.migrate_cached_sockets)+" μs",1)])),_:1}),n(Ts,{label:"过期的key数量"},{"default":c((()=>[m(u(s.sysInfo.stats.expired_keys),1)])),_:1})])),_:1})):y("",!0),s.sysInfo.stats?(i(),f(Bs,{key:3,"label-position":"right","label-width":"160px","class":"flex1",style:{"max-width":"460px"}},{"default":c((()=>[n(Ts,{label:"当前使用中的频道数量"},{"default":c((()=>[m(u(s.sysInfo.stats.pubsub_channels),1)])),_:1}),n(Ts,{label:"当前使用中的模式数量"},{"default":c((()=>[m(u(s.sysInfo.stats.pubsub_patterns),1)])),_:1}),n(Ts,{label:"不命中次数"},{"default":c((()=>[m(u(s.sysInfo.stats.keyspace_misses),1)])),_:1}),n(Ts,{label:"命中次数"},{"default":c((()=>[m(u(s.sysInfo.stats.keyspace_hits),1)])),_:1})])),_:1})):y("",!0)])])),_:1})])),_:1})]),r("div",Ls,[n(b,{xs:24,sm:24,md:24},{"default":c((()=>[n(h,{shadow:"nover","class":"box-card-height",style:{height:"auto"}},{header:c((()=>[Ps])),"default":c((()=>[s.sysInfo.keyspaceList&&s.sysInfo.keyspace?(i(),d("div",Us,[(i(!0),d(_,null,p(s.sysInfo.keyspaceList,((l,e)=>(i(),f(Bs,{style:{display:"flex",width:"100%"},key:e,"label-position":"right","label-width":"160px"},{"default":c((()=>[n(Ts,{"class":"flex1",label:"key名称"},{"default":c((()=>[m(u(l),1)])),_:2},1024),n(Ts,{"class":"flex1",label:"当前数据库key总数"},{"default":c((()=>[m(u(s.sysInfo.keyspace[l].keys),1)])),_:2},1024),n(Ts,{"class":"flex1",label:"带有过期时间的key总数"},{"default":c((()=>[m(u(s.sysInfo.keyspace[l].expires),1)])),_:2},1024),n(Ts,{"class":"flex1",label:"平均存活时间"},{"default":c((()=>[m(u(s.timeFormat(s.sysInfo.keyspace[l].avg_ttl/1e3)),1)])),_:2},1024)])),_:2},1024)))),128))])):y("",!0)])),_:1})])),_:1})])])}],["__scopeId","data-v-196f3044"]]);export{Ts as default};