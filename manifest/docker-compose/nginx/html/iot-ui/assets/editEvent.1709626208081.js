import{a as e}from"./index.170962620808122.js";import{_ as l,C as a,D as t,F as o,E as u}from"./index.1709626208081.js";import s from"./editOption.1709626208081.js";import{v as d}from"./validator.1709626208081.js";import{d as r,h as i,a1 as n,aa as p,a as m,Y as c,S as y,e as f,ah as g,o as v,b,W as h,X as F,F as _,a7 as j,aA as k,aB as D}from"./vue.1709626208081.js";import"./typeItem.1709626208081.js";const V={productKey:"",type:"",name:"",level:null,key:"",status:1,outputs:[],desc:""},C=r({name:"deviceEditPro",components:{Plus:a,Minus:t,Right:o,EditOption:s},setup(l,{emit:a}){const t=i(null),o=i(),s=n({isShowDialog:!1,typeData:[],type:"",types:"",productKey:"",elementType:{type:"",maxLength:""},enumdata:[{text:"",value:""}],jsondata:[],outputsdata:[],ruleForm:JSON.parse(JSON.stringify(V)),rules:{name:[{required:!0,message:"事件定义名称不能为空",trigger:"blur"},{max:32,message:"事件定义名称不能超过32个字符",trigger:"blur"},{validator:d,message:"事件定义名称不能包含空格",trigger:"blur"}],key:[{required:!0,message:"事件定义标识不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择数据类型",trigger:"blur"}]}}),r=()=>{s.ruleForm=JSON.parse(JSON.stringify(V)),s.type="",s.types="",s.outputsdata=[],s.elementType=[]},m=()=>{s.isShowDialog=!1};return{editOptionRef:o,getOptionData:(e,l)=>{"fun"==l?s.outputsdata.push(e):s.jsondata.push(e)},openDialog:(l,a)=>{r(),e.product.getDataType({status:-1}).then((e=>{const l=Object.values(e.dataType);l.forEach(((e,a)=>{0==a?(l[a].label="基础类型",l[a].options=e):(l[a].label="扩展类型",l[a].options=e)})),s.typeData=l||[]})),s.ruleForm=l,l.outputs&&(s.ruleForm=l,s.productKey=a,s.outputsdata=l.outputs),s.isShowDialog=!0},deljson:(e,l)=>{"fun"==l?s.outputsdata.splice(e,1):s.jsondata.splice(e,1)},editjson:(e,l)=>{"fun"==l?o.value.openDialog(s.outputsdata[e]):o.value.openDialog(s.jsondata[e])},addEnum:()=>{s.enumdata.push({text:"",value:""})},delEnum:e=>{s.enumdata.splice(e,1)},addJson:e=>{o.value.openDialog({productKey:"",id:0,type_data:e})},seletChange:e=>{s.type=e,s.ruleForm.type=e},seletChanges:e=>{s.types=e},closeDialog:m,onCancel:()=>{m()},onSubmit:()=>{const l=f(t);l&&l.validate((l=>{if(l){s.ruleForm.outputs=s.outputsdata;const l=0!==s.ruleForm.id?e.model.eventedit:e.model.eventadd;0!==s.ruleForm.id&&(s.ruleForm.productKey=s.productKey),l(s.ruleForm).then((()=>{u.success("事件定义类型操作成功"),m(),a("typeList")}))}}))},formRef:t,...p(s)}}}),O={"class":"system-edit-dic-container"},S={"class":"jsonlist"},x={"class":"jsonoption"},w={style:{display:"block",width:"100%"}},E=(e=>(k("data-v-3366c598"),e=e(),D(),e))((()=>b("div",null,"添加参数",-1))),T={"class":"dialog-footer"};var J=l(C,[["render",function(e,l,a,t,o,u){const s=g("el-input"),d=g("el-form-item"),r=g("el-radio"),i=g("el-radio-group"),n=g("el-link"),p=g("Plus"),f=g("el-icon"),k=g("el-form"),D=g("el-button"),V=g("el-dialog"),C=g("EditOption");return v(),m("div",O,[c(V,{title:(0!==e.ruleForm.id?"修改":"添加")+"事件定义",modelValue:e.isShowDialog,"onUpdate:modelValue":l[5]||(l[5]=l=>e.isShowDialog=l),width:"769px"},{footer:y((()=>[b("span",T,[c(D,{onClick:e.onCancel},{"default":y((()=>[h("取 消")])),_:1},8,["onClick"]),c(D,{type:"primary",onClick:e.onSubmit},{"default":y((()=>[h(F(0!==e.ruleForm.id?"修 改":"添 加"),1)])),_:1},8,["onClick"])])])),"default":y((()=>[c(k,{model:e.ruleForm,ref:"formRef",rules:e.rules,"label-width":"120px"},{"default":y((()=>[c(d,{label:"事件定义标识",prop:"key"},{"default":y((()=>[c(s,{modelValue:e.ruleForm.key,"onUpdate:modelValue":l[0]||(l[0]=l=>e.ruleForm.key=l),placeholder:"请输入事件定义标识",disabled:0!==e.ruleForm.id},null,8,["modelValue","disabled"])])),_:1}),c(d,{label:"事件定义名称",prop:"name"},{"default":y((()=>[c(s,{modelValue:e.ruleForm.name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ruleForm.name=l),placeholder:"请输入事件定义名称"},null,8,["modelValue"])])),_:1}),c(d,{label:"事件类型",prop:"level"},{"default":y((()=>[c(i,{modelValue:e.ruleForm.level,"onUpdate:modelValue":l[2]||(l[2]=l=>e.ruleForm.level=l)},{"default":y((()=>[c(r,{label:0},{"default":y((()=>[h("信息")])),_:1}),c(r,{label:1},{"default":y((()=>[h("告警")])),_:1}),c(r,{label:2},{"default":y((()=>[h("故障")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(d,{label:"输出参数",prop:"maxLength"},{"default":y((()=>[(v(!0),m(_,null,j(e.outputsdata,((l,a)=>(v(),m("div",{key:a,"class":"jslist"},[b("div",S,[b("div",null,"参数标识："+F(l.key),1),b("div",null,"参数名称："+F(l.name),1),b("div",null,"数据类型："+F(l.valueType.type),1),b("div",x,[c(n,{type:"primary",onClick:l=>e.editjson(a,"fun")},{"default":y((()=>[h("编辑")])),_:2},1032,["onClick"]),c(n,{type:"primary",onClick:l=>e.deljson(a,"fun")},{"default":y((()=>[h("删除")])),_:2},1032,["onClick"])])])])))),128)),b("div",w,[b("div",{"class":"input-options",onClick:l[3]||(l[3]=l=>e.addJson("fun"))},[c(f,null,{"default":y((()=>[c(p)])),_:1}),E])])])),_:1}),c(d,{label:"事件定义描述\t",prop:"desc"},{"default":y((()=>[c(s,{modelValue:e.ruleForm.desc,"onUpdate:modelValue":l[4]||(l[4]=l=>e.ruleForm.desc=l),type:"textarea",placeholder:"请输入事件定义描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"]),c(C,{ref:"editOptionRef",onTypeList:e.getOptionData},null,8,["onTypeList"])])}],["__scopeId","data-v-3366c598"]]);export{J as default};