import{a as e}from"./index.170962620808122.js";import{_ as l,C as a,D as t,F as o,E as u}from"./index.1709626208081.js";import p from"./editOption.1709626208081.js";import{v as d}from"./validator.1709626208081.js";import{d as n,h as s,a1 as m,aa as y,a as r,Y as i,S as c,e as v,ah as T,o as V,b as f,W as g,X as b,F as h,a7 as x,R as k,V as _,aA as j,aB as U}from"./vue.1709626208081.js";import"./typeItem.1709626208081.js";const F={id:0,productKey:"",name:"",dictType:"",type:"",key:"",transportProtocol:"",accessMode:1,status:1,valueType:{type:"",maxLength:""},desc:""},C=n({name:"deviceEditPro",components:{Plus:a,Minus:t,Right:o,EditOption:p},setup(l,{emit:a}){const t=s(null),o=s(),p=m({isShowDialog:!1,typeData:[],type:"",types:"",productKey:"",valueType:{type:"",maxLength:"",trueText:"是",trueValue:"true",falseText:"否",falseValue:"false"},elementType:{type:"",maxLength:""},enumdata:[{text:"",value:""}],jsondata:[],ruleForm:JSON.parse(JSON.stringify(F)),rules:{name:[{required:!0,message:"标签定义名称不能为空",trigger:"blur"},{max:32,message:"标签定义名称不能超过32个字符",trigger:"blur"},{validator:d,message:"标签定义名称不能包含空格",trigger:"blur"}],key:[{required:!0,message:"标签定义标识不能为空",trigger:"blur"}],accessMode:[{required:!0,message:"请选择是否只读",trigger:"blur"}],type:[{required:!0,message:"请选择数据类型",trigger:"blur"}]}}),n=()=>{p.ruleForm=JSON.parse(JSON.stringify(F)),p.type="",p.types="",p.valueType={},p.elementType={},p.jsondata=[],p.enumdata=[{text:"",value:""}]},r=()=>{p.isShowDialog=!1};return{editOptionRef:o,getOptionData:e=>{p.jsondata.push(e)},openDialog:(l,a)=>{n(),e.product.getDataType({status:-1}).then((e=>{const l=Object.values(e.dataType);l.forEach(((e,a)=>{0==a?(l[a].label="基础类型",l[a].options=e):(l[a].label="扩展类型",l[a].options=e)})),p.typeData=l||[]})),p.ruleForm=l,l.valueType&&(p.ruleForm=l,p.productKey=a,p.valueType=l.valueType,p.ruleForm.valueType.type=l.valueType.type,p.ruleForm.type=l.valueType.type,p.type=l.valueType.type,p.ruleForm.accessMode=l.accessMode,l.valueType.elementType&&(p.elementType=l.valueType.elementType,p.types=l.valueType.elementType.type),"enum"==l.type&&(p.enumdata=l.valueType.elements),"object"==l.type&&(p.jsondata=l.valueType.properties),"array"==l.type&&"enum"==p.types&&(p.enumdata=l.valueType.elementType.elements),"array"==l.type&&"object"==p.types&&(p.jsondata=l.valueType.elementType.properties)),p.isShowDialog=!0},deljson:e=>{p.jsondata.splice(e,1)},addEnum:()=>{p.enumdata.push({text:"",value:""})},delEnum:e=>{p.enumdata.splice(e,1)},addJson:()=>{o.value.openDialog({productKey:"",id:0})},seletChange:e=>{p.type=e,p.ruleForm.type=e},seletChanges:e=>{p.types=e},closeDialog:r,onCancel:()=>{r()},onSubmit:()=>{const l=v(t);l&&l.validate((l=>{l&&(0!==p.ruleForm.id?("enum"==p.type&&(p.valueType.elements=p.enumdata),"object"==p.type&&(p.valueType.properties=p.jsondata),"array"==p.type&&(p.valueType.elementType=p.elementType,"enum"==p.types&&(p.valueType.elementType={elements:p.enumdata,type:"enum"}),"object"==p.types&&(p.valueType.elementType={properties:p.jsondata,type:"object"})),p.ruleForm.valueType=p.valueType,p.ruleForm.productKey=p.productKey,e.model.tagedit(p.ruleForm).then((()=>{u.success("标签定义类型修改成功"),r(),a("typeList")}))):("enum"==p.type&&(p.valueType.elements=p.enumdata),"object"==p.type&&(p.valueType.properties=p.jsondata),"array"==p.type&&(p.valueType.elementType=p.elementType,"enum"==p.types&&(p.valueType.elementType={elements:p.enumdata}),"object"==p.types&&(p.valueType.elementType={properties:p.jsondata,type:"object"})),p.ruleForm.valueType=p.valueType,e.model.tagadd(p.ruleForm).then((()=>{u.success("标签定义类型添加成功"),r(),a("typeList")}))))}))},formRef:t,...y(p)}}}),L=e=>(j("data-v-26505d6e"),e=e(),U(),e),D={"class":"system-edit-dic-container"},O={"class":"input-box"},S=L((()=>f("span",{style:{margin:"0px 10px"}},"~",-1))),w={"class":"input-box"},E=L((()=>f("span",{style:{margin:"0px 10px"}},"~",-1))),J={style:{margin:"0px 10px"}},M={"class":"input-option"},R={"class":"jsonlist"},K=L((()=>f("div",null,"参数名称：",-1))),N={style:{width:"60%"}},q={"class":"jsonoption"},P={style:{display:"block",width:"100%"}},I=L((()=>f("div",null,"添加参数",-1))),A={key:7},B={"class":"input-box"},W=L((()=>f("span",{style:{margin:"0px 10px"}},"~",-1))),X={"class":"input-box"},Y=L((()=>f("span",{style:{margin:"0px 10px"}},"~",-1))),z={style:{margin:"0px 10px"}},G={"class":"input-option"},H={"class":"jsonlist"},Q=L((()=>f("div",null,"参数名称：",-1))),Z={style:{width:"60%"}},$={"class":"jsonoption"},ee={style:{display:"block",width:"100%"}},le=L((()=>f("div",null,"添加参数",-1))),ae={"class":"dialog-footer"};var te=l(C,[["render",function(e,l,a,t,o,u){const p=T("el-input"),d=T("el-form-item"),n=T("el-option"),s=T("el-option-group"),m=T("el-select"),y=T("Right"),v=T("el-icon"),j=T("Plus"),U=T("Minus"),F=T("el-link"),C=T("el-radio"),L=T("el-radio-group"),te=T("el-form"),oe=T("el-button"),ue=T("el-dialog"),pe=T("EditOption");return V(),r("div",D,[i(ue,{title:(0!==e.ruleForm.id?"修改":"添加")+"标签定义",modelValue:e.isShowDialog,"onUpdate:modelValue":l[24]||(l[24]=l=>e.isShowDialog=l),width:"769px"},{footer:c((()=>[f("span",ae,[i(oe,{onClick:e.onCancel},{"default":c((()=>[g("取 消")])),_:1},8,["onClick"]),i(oe,{type:"primary",onClick:e.onSubmit},{"default":c((()=>[g(b(0!==e.ruleForm.id?"修 改":"添 加"),1)])),_:1},8,["onClick"])])])),"default":c((()=>[i(te,{model:e.ruleForm,ref:"formRef",rules:e.rules,"label-width":"120px"},{"default":c((()=>[i(d,{label:"标签定义标识",prop:"key"},{"default":c((()=>[i(p,{modelValue:e.ruleForm.key,"onUpdate:modelValue":l[0]||(l[0]=l=>e.ruleForm.key=l),placeholder:"请输入标签定义标识",disabled:0!==e.ruleForm.id},null,8,["modelValue","disabled"])])),_:1}),i(d,{label:"标签定义名称",prop:"name"},{"default":c((()=>[i(p,{modelValue:e.ruleForm.name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ruleForm.name=l),placeholder:"请输入标签定义名称"},null,8,["modelValue"])])),_:1}),i(d,{label:"数据类型",prop:"type"},{"default":c((()=>[i(m,{modelValue:e.valueType.type,"onUpdate:modelValue":l[2]||(l[2]=l=>e.valueType.type=l),placeholder:"请选择数据类型",onChange:e.seletChange},{"default":c((()=>[(V(!0),r(h,null,x(e.typeData,(e=>(V(),k(s,{key:e.label,label:e.label},{"default":c((()=>[(V(!0),r(h,null,x(e.options,(e=>(V(),k(n,{key:e.type,label:e.title,value:e.type},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),"float"==e.type||"double"==e.type?(V(),k(d,{key:0,label:"精度",prop:"decimals"},{"default":c((()=>[i(p,{modelValue:e.valueType.decimals,"onUpdate:modelValue":l[3]||(l[3]=l=>e.valueType.decimals=l),placeholder:"请输入精度"},null,8,["modelValue"])])),_:1})):_("",!0),"int"==e.type||"long"==e.type||"float"==e.type||"double"==e.type?(V(),k(d,{key:1,label:"单位",prop:"unit"},{"default":c((()=>[i(p,{modelValue:e.valueType.unit,"onUpdate:modelValue":l[4]||(l[4]=l=>e.valueType.unit=l),placeholder:"请输入单位"},null,8,["modelValue"])])),_:1})):_("",!0),"string"==e.type?(V(),k(d,{key:2,label:"最大长度",prop:"maxLength"},{"default":c((()=>[i(p,{modelValue:e.valueType.maxLength,"onUpdate:modelValue":l[5]||(l[5]=l=>e.valueType.maxLength=l),placeholder:"请输入最大长度"},null,8,["modelValue"])])),_:1})):_("",!0),"date"==e.type?(V(),k(d,{key:3,label:"时间格式",prop:"maxLength"},{"default":c((()=>[i(p,{modelValue:e.valueType.maxLength,"onUpdate:modelValue":l[6]||(l[6]=l=>e.valueType.maxLength=l),placeholder:"请输入时间格式"},null,8,["modelValue"])])),_:1})):_("",!0),"boolean"==e.type?(V(),k(d,{key:4,label:"布尔值",prop:"trueText"},{"default":c((()=>[f("div",O,[i(p,{modelValue:e.valueType.trueText,"onUpdate:modelValue":l[7]||(l[7]=l=>e.valueType.trueText=l),placeholder:"请输入布尔值",value:"是"},null,8,["modelValue"]),S,i(p,{modelValue:e.valueType.trueValue,"onUpdate:modelValue":l[8]||(l[8]=l=>e.valueType.trueValue=l),placeholder:"请输入布尔值",value:"true"},null,8,["modelValue"])]),f("div",w,[i(p,{modelValue:e.valueType.falseText,"onUpdate:modelValue":l[9]||(l[9]=l=>e.valueType.falseText=l),placeholder:"请输入布尔值",value:"否"},null,8,["modelValue"]),g(),E,i(p,{modelValue:e.valueType.falseValue,"onUpdate:modelValue":l[10]||(l[10]=l=>e.valueType.falseValue=l),placeholder:"请输入布尔值",value:"false"},null,8,["modelValue"])])])),_:1})):_("",!0),"enum"==e.type?(V(),k(d,{key:5,label:"枚举项",prop:"maxLength"},{"default":c((()=>[(V(!0),r(h,null,x(e.enumdata,((l,a)=>(V(),r("div",{"class":"input-box",key:a},[i(p,{modelValue:l.text,"onUpdate:modelValue":e=>l.text=e,placeholder:"请输入枚举文本"},null,8,["modelValue","onUpdate:modelValue"]),f("span",J,[i(v,null,{"default":c((()=>[i(y)])),_:1})]),i(p,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,placeholder:"请输入枚举值"},null,8,["modelValue","onUpdate:modelValue"]),f("div",M,[0==a?(V(),k(v,{key:0,onClick:e.addEnum},{"default":c((()=>[i(j)])),_:1},8,["onClick"])):_("",!0),0!=a?(V(),k(v,{key:1,onClick:l=>e.delEnum(a)},{"default":c((()=>[i(U)])),_:2},1032,["onClick"])):_("",!0)])])))),128))])),_:1})):_("",!0),"object"==e.type?(V(),k(d,{key:6,label:"JSON对象",prop:"maxLength"},{"default":c((()=>[(V(!0),r(h,null,x(e.jsondata,((l,a)=>(V(),r("div",{key:a,"class":"jslist"},[f("div",R,[K,f("div",N,b(l.name),1),f("div",q,[i(F,{type:"primary",onClick:l=>e.deljson(a)},{"default":c((()=>[g("删除")])),_:2},1032,["onClick"])])])])))),128)),f("div",P,[f("div",{"class":"input-options",onClick:l[11]||(l[11]=(...l)=>e.addJson&&e.addJson(...l))},[i(v,null,{"default":c((()=>[i(j)])),_:1}),I])])])),_:1})):_("",!0),"array"==e.type?(V(),r("div",A,[i(d,{label:"元素类型",prop:"types"},{"default":c((()=>[i(m,{modelValue:e.elementType.type,"onUpdate:modelValue":l[12]||(l[12]=l=>e.elementType.type=l),placeholder:"请选择元素类型",onChange:e.seletChanges},{"default":c((()=>[(V(!0),r(h,null,x(e.typeData,(e=>(V(),k(s,{key:e.label,label:e.label},{"default":c((()=>[(V(!0),r(h,null,x(e.options,(e=>(V(),k(n,{key:e.type,label:e.title,value:e.type,disabled:"array"==e.type},null,8,["label","value","disabled"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),"float"==e.types||"double"==e.types?(V(),k(d,{key:0,label:"精度",prop:"decimals"},{"default":c((()=>[i(p,{modelValue:e.elementType.decimals,"onUpdate:modelValue":l[13]||(l[13]=l=>e.elementType.decimals=l),placeholder:"请输入精度"},null,8,["modelValue"])])),_:1})):_("",!0),"int"==e.types||"long"==e.types||"float"==e.types||"double"==e.types?(V(),k(d,{key:1,label:"单位",prop:"unit"},{"default":c((()=>[i(p,{modelValue:e.elementType.unit,"onUpdate:modelValue":l[14]||(l[14]=l=>e.elementType.unit=l),placeholder:"请输入单位"},null,8,["modelValue"])])),_:1})):_("",!0),"string"==e.types?(V(),k(d,{key:2,label:"最大长度",prop:"maxLength"},{"default":c((()=>[i(p,{modelValue:e.elementType.maxLength,"onUpdate:modelValue":l[15]||(l[15]=l=>e.elementType.maxLength=l),placeholder:"请输入最大长度"},null,8,["modelValue"])])),_:1})):_("",!0),"date"==e.types?(V(),k(d,{key:3,label:"时间格式",prop:"maxLength"},{"default":c((()=>[i(p,{modelValue:e.elementType.maxLength,"onUpdate:modelValue":l[16]||(l[16]=l=>e.elementType.maxLength=l),placeholder:"请输入时间格式"},null,8,["modelValue"])])),_:1})):_("",!0),"boolean"==e.types?(V(),k(d,{key:4,label:"布尔值",prop:"maxLength"},{"default":c((()=>[f("div",B,[i(p,{modelValue:e.elementType.trueText,"onUpdate:modelValue":l[17]||(l[17]=l=>e.elementType.trueText=l),placeholder:"请输入布尔值",value:"是"},null,8,["modelValue"]),W,i(p,{modelValue:e.elementType.trueValue,"onUpdate:modelValue":l[18]||(l[18]=l=>e.elementType.trueValue=l),placeholder:"请输入布尔值",value:"true"},null,8,["modelValue"])]),f("div",X,[i(p,{modelValue:e.elementType.falseText,"onUpdate:modelValue":l[19]||(l[19]=l=>e.elementType.falseText=l),placeholder:"请输入布尔值",value:"否"},null,8,["modelValue"]),g(),Y,i(p,{modelValue:e.elementType.falseValue,"onUpdate:modelValue":l[20]||(l[20]=l=>e.elementType.falseValue=l),placeholder:"请输入布尔值",value:"false"},null,8,["modelValue"])])])),_:1})):_("",!0),"enum"==e.types?(V(),k(d,{key:5,label:"枚举项",prop:"maxLength"},{"default":c((()=>[(V(!0),r(h,null,x(e.enumdata,((l,a)=>(V(),r("div",{"class":"input-box",key:a},[i(p,{modelValue:l.text,"onUpdate:modelValue":e=>l.text=e,placeholder:"请输入枚举文本"},null,8,["modelValue","onUpdate:modelValue"]),f("span",z,[i(v,null,{"default":c((()=>[i(y)])),_:1})]),i(p,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,placeholder:"请输入枚举值"},null,8,["modelValue","onUpdate:modelValue"]),f("div",G,[0==a?(V(),k(v,{key:0,onClick:e.addEnum},{"default":c((()=>[i(j)])),_:1},8,["onClick"])):_("",!0),0!=a?(V(),k(v,{key:1,onClick:l=>e.delEnum(a)},{"default":c((()=>[i(U)])),_:2},1032,["onClick"])):_("",!0)])])))),128))])),_:1})):_("",!0)])):_("",!0),"object"==e.types?(V(),k(d,{key:8,label:"JSON对象",prop:"maxLength"},{"default":c((()=>[(V(!0),r(h,null,x(e.jsondata,((e,l)=>(V(),r("div",{key:l,"class":"jslist"},[f("div",H,[Q,f("div",Z,b(e.name),1),f("div",$,[i(F,{type:"primary"},{"default":c((()=>[g("编辑")])),_:1}),i(F,{type:"primary"},{"default":c((()=>[g("删除")])),_:1})])])])))),128)),f("div",ee,[f("div",{"class":"input-options",onClick:l[21]||(l[21]=(...l)=>e.addJson&&e.addJson(...l))},[i(v,null,{"default":c((()=>[i(j)])),_:1}),le])])])),_:1})):_("",!0),i(d,{label:"是否只读",prop:"accessMode"},{"default":c((()=>[i(L,{modelValue:e.ruleForm.accessMode,"onUpdate:modelValue":l[22]||(l[22]=l=>e.ruleForm.accessMode=l)},{"default":c((()=>[i(C,{label:1},{"default":c((()=>[g("只读")])),_:1}),i(C,{label:0},{"default":c((()=>[g("读写")])),_:1})])),_:1},8,["modelValue"])])),_:1}),i(d,{label:"标签定义描述\t",prop:"desc"},{"default":c((()=>[i(p,{modelValue:e.ruleForm.desc,"onUpdate:modelValue":l[23]||(l[23]=l=>e.ruleForm.desc=l),type:"textarea",placeholder:"请输入标签定义描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"]),i(pe,{ref:"editOptionRef",onTypeList:e.getOptionData},null,8,["onTypeList"])])}],["__scopeId","data-v-26505d6e"]]);export{te as default};