import{g as e,E as l,_ as a}from"./index.1709626208081.js";import{d as t,h as i,R as o,S as r,e as n,ah as s,o as u,Y as d,W as m,a1 as p,j as c,b,a as y,a7 as g,F as T,V as k}from"./vue.1709626208081.js";import{c as F}from"./index.17096262080818.js";const f=t({__name:"uploadFile",props:{accept:{type:String,"default":""},url:{type:String,"default":"/common/singleFile"}},emits:["update"],setup(a,{emit:t}){const p=localStorage.uploadFileWay,c={Authorization:"Bearer "+localStorage.token},b=t,y=a,g=i([]),T=e("/base-api/api/v1"+y.url),k=e=>{if(0!==e.code)return l.error(e.message);l.success("文件上传成功"),g.value=[],b("update",e.data.full_path)},F=e=>!(e.size/1024/1024>2)||(l.error("文件不能超过2MB!"),!1);return(e,l)=>{const t=s("ele-Upload"),i=s("el-icon"),b=s("el-button"),y=s("el-upload");return u(),o(y,{accept:a.accept,"show-file-list":!1,"file-list":g.value,"onUpdate:fileList":l[0]||(l[0]=e=>g.value=e),limit:1,data:{source:n(p)},headers:c,"before-upload":F,action:n(T),"on-success":k},{"default":r((()=>[d(b,null,{"default":r((()=>[d(i,null,{"default":r((()=>[d(t)])),_:1}),m(" 数据导入 ")])),_:1})])),_:1},8,["accept","file-list","data","action"])}}});const I={"class":"dialog-footer"};var h=a(t({__name:"editParams",emits:["update"],setup(e,{expose:a,emit:t}){const h=t,_=i(),C=p({dialogVisible:!1,activeName:"1",id:0,ruleForm:{},rules:{name:[{required:!0,message:"证书名称不能为空",trigger:"blur"}],standard:[{required:!0,message:"证书标准不能为空",trigger:["blur","change"]}],fileContent:[{required:!0,message:"证书文件不能为空",trigger:"blur"}],publicKeyContent:[{required:!0,message:"证书公钥不能为空",trigger:["blur","change"]}],privateKeyContent:[{required:!0,message:"证书私钥不能为空",trigger:["blur","change"]}]},columns:[{columnId:29,tableId:3,TableName:"",columnName:"business_type",columnComment:"0其它 1新增 2修改 3删除",columnType:"varchar(1)",columnKey:"",goType:"string",goField:"BusinessType",jsonField:"businessType",htmlField:"",isPk:"0",isIncrement:"",isRequired:"0",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"datetime",dictType:"",sort:3,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:31,tableId:3,TableName:"",columnName:"method",columnComment:"请求方法",columnType:"varchar(255)",columnKey:"",goType:"string",goField:"Method",jsonField:"method",htmlField:"",isPk:"0",isIncrement:"",isRequired:"0",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"input",dictType:"",sort:4,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:33,tableId:3,TableName:"",columnName:"oper_name",columnComment:"操作人员",columnType:"varchar(255)",columnKey:"",goType:"string",goField:"OperName",jsonField:"operName",htmlField:"",isPk:"0",isIncrement:"",isRequired:"1",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"LIKE",htmlType:"input",dictType:"",sort:5,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:35,tableId:3,TableName:"",columnName:"oper_url",columnComment:"操作url",columnType:"varchar(255)",columnKey:"",goType:"string",goField:"OperUrl",jsonField:"operUrl",htmlField:"",isPk:"0",isIncrement:"",isRequired:"0",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"input",dictType:"",sort:6,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:37,tableId:3,TableName:"",columnName:"oper_ip",columnComment:"操作IP",columnType:"varchar(255)",columnKey:"",goType:"string",goField:"OperIp",jsonField:"operIp",htmlField:"",isPk:"0",isIncrement:"",isRequired:"0",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"input",dictType:"",sort:7,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:41,tableId:3,TableName:"",columnName:"status",columnComment:"0=正常,1=异常",columnType:"varchar(1)",columnKey:"",goType:"string",goField:"Status",jsonField:"status",htmlField:"",isPk:"0",isIncrement:"",isRequired:"1",isInsert:"1",isEdit:"1",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"radio",dictType:"",sort:10,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""},{columnId:42,tableId:3,TableName:"",columnName:"oper_id",columnComment:"",columnType:"bigint(20)",columnKey:"",goType:"int64",goField:"OperId",jsonField:"operId",htmlField:"",isPk:"1",isIncrement:"",isRequired:"0",isInsert:"1",isEdit:"0",isList:"1",isQuery:"1",queryType:"EQ",htmlType:"input",dictType:"",sort:1,linkTableName:"",linkTableClass:"",linkTablePackage:"",linkLabelId:"",linkLabelName:""}]}),{proxy:N}=c(),{network_certificate:V}=N.useDict("network_certificate"),v=()=>{var e;C.dialogVisible=!1,C.ruleForm={},null==(e=_.value)||e.clearValidate()},L=(e,l)=>{let a=new FileReader;a.readAsText(l[l.length-1].raw,"UTF-8"),a.onload=function(e){let l=e.target.result.split("\r\n");C.ruleForm.publicKeyContent=l[0]}},q=(e,l)=>{let a=new FileReader;a.readAsText(l[l.length-1].raw,"UTF-8"),a.onload=function(e){let l=e.target.result.split("\r\n");C.ruleForm.privateKeyContent=l[0]}},K=e=>{C.ruleForm.fileContent=e};return a({openDialog:e=>{e&&(C.ruleForm=e),C.dialogVisible=!0}}),(e,a)=>{const t=s("el-option"),i=s("el-select"),p=s("el-form-item"),c=s("el-input"),N=s("el-button"),P=s("el-upload"),E=s("el-form"),U=s("el-dialog");return u(),o(U,{onClose:v,title:C.ruleForm.id?"编辑证书":"新增证书",modelValue:C.dialogVisible,"onUpdate:modelValue":a[7]||(a[7]=e=>C.dialogVisible=e),width:"60%"},{footer:r((()=>[b("div",I,[d(N,{type:"default",onClick:v},{"default":r((()=>[m("取 消")])),_:1}),d(N,{type:"primary",onClick:a[6]||(a[6]=e=>(async e=>{e&&await e.validate((e=>{e&&(C.ruleForm.id?F.certificateManagement.edit(C.ruleForm).then((()=>{l.success("证书编辑成功"),C.dialogVisible=!1,h("update"),C.ruleForm={}})):F.certificateManagement.add(C.ruleForm).then((()=>{l.success("证书添加成功"),C.dialogVisible=!1,h("update"),C.ruleForm={}})))}))})(_.value))},{"default":r((()=>[m("提 交")])),_:1})])])),"default":r((()=>[d(E,{rules:C.rules,ref_key:"ruleForm",ref:_,model:C.ruleForm,"label-width":"120px"},{"default":r((()=>[d(p,{label:"证书标准",prop:"standard"},{"default":r((()=>[d(i,{modelValue:C.ruleForm.standard,"onUpdate:modelValue":a[0]||(a[0]=e=>C.ruleForm.standard=e),placeholder:"请选择证书标准"},{"default":r((()=>[(u(!0),y(T,null,g(n(V),(e=>(u(),o(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(p,{label:"证书名称",prop:"name"},{"default":r((()=>[d(c,{modelValue:C.ruleForm.name,"onUpdate:modelValue":a[1]||(a[1]=e=>C.ruleForm.name=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1}),d(p,{label:"证书文件",prop:"fileContent"},{"default":r((()=>[C.ruleForm.fileContent?(u(),o(c,{key:0,disabled:"",modelValue:C.ruleForm.fileContent,"onUpdate:modelValue":a[2]||(a[2]=e=>C.ruleForm.fileContent=e)},null,8,["modelValue"])):k("",!0),d(f,{onUpdate:K})])),_:1}),d(p,{label:"证书公钥",prop:"publicKeyContent"},{"default":r((()=>[d(c,{disabled:"",type:"textarea",rows:6,modelValue:C.ruleForm.publicKeyContent,"onUpdate:modelValue":a[3]||(a[3]=e=>C.ruleForm.publicKeyContent=e)},null,8,["modelValue"]),d(P,{"class":"upload-demo",action:"",accept:".txt","on-change":L,"auto-upload":!1},{"default":r((()=>[d(N,{size:"small",type:"primary"},{"default":r((()=>[m("上传")])),_:1})])),_:1})])),_:1}),d(p,{label:"证书私钥",prop:"privateKeyContent"},{"default":r((()=>[d(c,{disabled:"",type:"textarea",rows:6,modelValue:C.ruleForm.privateKeyContent,"onUpdate:modelValue":a[4]||(a[4]=e=>C.ruleForm.privateKeyContent=e)},null,8,["modelValue"]),d(P,{"class":"upload-demo",action:"",accept:".txt","on-change":q,"auto-upload":!1},{"default":r((()=>[d(N,{size:"small",type:"primary"},{"default":r((()=>[m("上传")])),_:1})])),_:1})])),_:1}),d(p,{label:"说明"},{"default":r((()=>[d(c,{type:"textarea",rows:6,modelValue:C.ruleForm.description,"onUpdate:modelValue":a[5]||(a[5]=e=>C.ruleForm.description=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-8879fb1a"]]);export{h as default};