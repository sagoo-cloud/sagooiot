import{a as e}from"./modbus.1709626208081.js";import{_ as t,E as l}from"./index.1709626208081.js";import{R as a,S as i,ah as o,o as s,Y as m,W as p,a as d,a7 as u,F as r}from"./vue.1709626208081.js";var n=t({components:{},props:{formatOptions:{"default":()=>[],type:Array}},data:()=>({temp:{title:"",interval:"20s",encoding:"json",publishTopic:"",deviceNumber:"",number:"",templateNumber:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"change"}],publishTopic:[{required:!0,message:"请输入mqtt主题",trigger:"change"}],templateNumber:[{required:!0,message:"请选择设备模板",trigger:"change"}]},dialogVisible:!1,listLoading:!1,dialogStatus:"update",textMap:{update:"任务详情",create:"添加任务"},templateOptions:[]}),methods:{openDialog({dialogStatus:e,row:t,deviceNumber:l}){var a;this.dialogStatus=e,this.temp.deviceNumber=l,t&&(this.temp.number=t.Job.number,this.temp.title=t.Job.title,this.temp.interval=t.Job.interval,this.temp.encoding=t.Job.encoding,this.temp.publishTopic=t.Job.publishTopic,this.temp.templateNumber=null==(a=null==t?void 0:t.Template)?void 0:a.number),this.getTemplateList(),this.dialogVisible=!0},closeDialog(){this.dialogVisible=!1,this.temp={title:"",interval:"20s",encoding:"json",publishTopic:"",deviceNumber:"",number:"",templateNumber:""},this.$refs.dataForm.resetFields()},getTemplateList(){this.listLoading=!0,e.template.getList({page:1,size:50}).then((e=>{this.templateOptions=e.list||[]}))["finally"]((()=>{this.listLoading=!1}))},createData(){this.$refs.dataForm.validate((t=>{t&&e.task.addDeviceJob(this.temp).then((()=>{this.$emit("finish"),this.closeDialog(),l.success("操作成功！")}))}))},updateData(){this.$refs.dataForm.validate((t=>{t&&e.task.editDeviceJob(this.temp).then((()=>{this.$emit("finish"),this.closeDialog(),l.success("操作成功！")}))}))}}},[["render",function(e,t,l,n,b,c){const h=o("el-input"),g=o("el-form-item"),f=o("el-option"),v=o("el-select"),V=o("el-form"),D=o("el-button"),_=o("el-dialog");return s(),a(_,{title:b.textMap[b.dialogStatus],modelValue:b.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>b.dialogVisible=e),width:"500px","before-close":c.closeDialog,"append-to-body":"","close-on-click-modal":!1},{footer:i((()=>[m(D,{onClick:c.closeDialog},{"default":i((()=>[p(" 取 消 ")])),_:1},8,["onClick"]),m(D,{type:"primary",onClick:t[5]||(t[5]=e=>"create"===b.dialogStatus?c.createData():c.updateData())},{"default":i((()=>[p(" 保 存 ")])),_:1})])),"default":i((()=>[m(V,{ref:"dataForm",rules:b.rules,model:b.temp,"label-width":"80px"},{"default":i((()=>[m(g,{label:"标题",prop:"title"},{"default":i((()=>[m(h,{modelValue:b.temp.title,"onUpdate:modelValue":t[0]||(t[0]=e=>b.temp.title=e),placeholder:"请输入标题"},null,8,["modelValue"])])),_:1}),m(g,{label:"调度周期",prop:"interval"},{"default":i((()=>[m(h,{modelValue:b.temp.interval,"onUpdate:modelValue":t[1]||(t[1]=e=>b.temp.interval=e),placeholder:"请输入调度周期"},null,8,["modelValue"])])),_:1}),m(g,{label:"转发格式",prop:"encoding"},{"default":i((()=>[m(v,{modelValue:b.temp.encoding,"onUpdate:modelValue":t[2]||(t[2]=e=>b.temp.encoding=e),placeholder:"请选择转发格式",style:{width:"100%"}},{"default":i((()=>[(s(!0),d(r,null,u(l.formatOptions,(e=>(s(),a(f,{key:e.value,label:e.title,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(g,{label:"mqtt主题",prop:"publishTopic"},{"default":i((()=>[m(h,{modelValue:b.temp.publishTopic,"onUpdate:modelValue":t[3]||(t[3]=e=>b.temp.publishTopic=e),placeholder:"请输入mqtt主题"},null,8,["modelValue"])])),_:1}),m(g,{label:"设备模板",prop:"templateNumber"},{"default":i((()=>[m(v,{modelValue:b.temp.templateNumber,"onUpdate:modelValue":t[4]||(t[4]=e=>b.temp.templateNumber=e),filterable:"",placeholder:"请选择设备模板",style:{width:"100%"}},{"default":i((()=>[(s(!0),d(r,null,u(b.templateOptions,(e=>(s(),a(f,{key:e.number,label:e.title,value:e.number},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue","before-close"])}]]);export{n as default};